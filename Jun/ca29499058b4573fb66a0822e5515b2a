WASHINGTON — A bipartisan gun violence bill that seemed unimaginable a month ago is on the verge of winning final congressional approval, a vote that will produce lawmakers’ most sweeping answer in decades to brutal mass shootings that have come to shock yet not surprise Americans. The House was set to vote on the $13 billion package Friday, a month after a gunman massacred 19 students and two teachers at a Uvalde, Texas, elementary school. In Buffalo, New York, a white man authorities said was motivated by racism is accused of killing 10 Black grocery shoppers just days before Uvalde. The two slaughters — days apart and victimizing helpless people for whom the public felt immediate empathy — prompted both parties to conclude that Congress had to act, especially in an election year. After weeks of closed-door talks, Senate bargainers from both parties produced a compromise taking mild but impactful steps toward making such mayhem less likely. “Families in Uvalde and Buffalo, and too many tragic shootings before, have demanded action. And tonight, we acted,” President Joe Biden said after passage. He said the House should send it to him quickly, adding, “Kids in schools and communities will be safer because of it.” The legislation would toughen background checks for the youngest gun buyers, keep firearms from more domestic violence offenders and help states put in place red flag laws that make it easier for authorities to take weapons from people adjudged dangerous. It would also fund local programs for school safety, mental health and violence prevention. The Senate approved the measure Thursday by 65-33. Fifteen Republicans — a remarkably high number for a party that has derailed gun curbs for years — joined all 50 Democrats, including their two independent allies, in approving the bill. Still, that meant that fewer than one-third of GOP senators backed the measure. And with Republicans in the House expected to solidly oppose it, the fate of future congressional action on guns seems dubious, even as the GOP is expected to win House and possibly Senate control in the November elections. Top House Republicans urged a “no” vote in an email from the No. 2 GOP leader, Rep. Steve Scalise of Louisiana. He called the bill “an effort to slowly chip away at law-abiding citizens’ 2nd Amendment rights.” While the bill was noteworthy for its contrast with years of stalemate in Washington, it falls far short of more robust gun restrictions Democrats have sought and Republicans have thwarted for years. Those included bans on the assault-type weapons and high-capacity ammunition magazines used in the slayings in Buffalo and Uvalde. Yet the accord let both parties’ Senate leaders declare victory and demonstrate to voters that they know how to compromise and make government work, while also leaving room for each side to appeal to its core supporters. “This is not a cure-all for all the ways gun violence affects our nation,” said Senate Majority Leader Chuck Schumer, D-N.Y., whose party has made gun restrictions a goal for decades. “But it is a long overdue step in the right direction.” Senate Minority Leader Mitch McConnell, R-Ky., in a nod to the Second Amendment right to bear arms that drives many conservative voters, said “the American people want their constitutional rights protected and their kids to be safe in school.” The day proved bittersweet for advocates of curtailing gun violence. Underscoring the enduring potency of conservative cIout, the right-leaning Supreme Court issued a decision expanding the right of Americans to carry arms in public by striking down a New York law requiring people to prove a need for carrying a weapon before they get a license to do so. Hours before final passage, the Senate voted 65-34 to end a filibuster by conservative GOP senators aimed at killing the legislation. That was five more than the 60-vote threshold needed. Yet the Senate votes highlighted the wariness most Republicans feel about defying the party’s pro-gun voters and firearms groups like the National Rifle Association. Sens. Lisa Murkowski of Alaska and Todd Young of Indiana were the only two of the 15 up for reelection this fall. Of the rest, four are retiring and eight don’t face voters until 2026. Tellingly, GOP senators voting “no” included potential 2024 presidential contenders like Ted Cruz of Texas, Josh Hawley of Missouri and Tim Scott of South Carolina. Cruz said the legislation would “disarm law-abiding citizens rather than take serious measures to protect our children.” The talks that produced the bill were led by Sens. Chris Murphy, D-Conn., Kyrsten Sinema, D-Ariz., John Cornyn, R-Texas, and Thom Tillis, R-N.C. Murphy represented Newtown, Connecticut, when an assailant killed 20 students and six staffers at Sandy Hook Elementary School in 2012, while Cornyn has been involved in past gun talks following mass shootings in his state and is close to McConnell. The bill would make the local juvenile records of people age 18 to 20 available during required federal background checks when they attempt to buy guns. Those examinations, currently limited to three days, would last up to a maximum of 10 days to give federal and local officials time to search records. People convicted of domestic abuse who are current or former romantic partners of the victim would be prohibited from acquiring firearms, closing the so-called “boyfriend loophole.” That ban currently only applies to people married to, living with or who have had children with the victim. There would be money to help states enforce red flag laws and for other states without them that for violence prevention programs. Nineteen states and the District of Columbia have such laws. The measure expands the use of background checks by rewriting the definition of the federally licensed gun dealers required to conduct them. Penalties for gun trafficking are strengthened, billions of dollars are provided for behavioral health clinics and school mental health programs and there’s money for school safety initiatives, though not for personnel to use a “dangerous weapon.” By ALAN FRAM